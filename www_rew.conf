if ($request_uri ~* ^\/htmls.*) {
  rewrite ^/htmls/(.*) /$1 permanent;
}

if ($request_uri ~* ^\/news\/\d\d\d\d\d\d\d\d\/.+\.shtml) {
  rewrite  ^/news/(\d\d\d\d)(\d\d\d\d)/(.+)\.shtml$ /htmls/news/$1/$2/$3.shtml break;
  #rewrite  ^/news/(\d\d\d\d)(\d\d\d\d)/(.+)\.shtml$ http://www.m1905.com/ break;
}

if ($request_uri ~* ^\/vod\/[a-z]*\/\d\d\d+\.shtml) {
  rewrite  ^/vod/([a-z]*)/(\d)(\d)(\d+).shtml$ /htmls/vod/$1/$2/$3/$2$3$4.shtml break;
}
if ($request_uri ~* ^\/video\/play\/\d\d\d+\.shtml) {
  rewrite  ^/video/play/(\d)(\d)(\d+).shtml$ /htmls/video/play/$1/$2/$1$2$3.shtml break;
}
if ($request_uri ~* ^\/newgallery\/hdpic\/\d\d\d+\.shtml) {
  rewrite  ^/newgallery/hdpic/(\d)(\d)(\d+).shtml$ /htmls/newgallery/hdpic/$1/$2/$1$2$3.shtml break;
}

if (-e "$document_root/htmls$uri") {
  rewrite  ^/(.*) /htmls/$1 break;
}

rewrite ^/([a-z]+)/([a-z]+)/lst/(.*)$ /list/route.php?c=$1&a=$2&u=$3 last;
rewrite  ^/mdb/(.+)/? /mdb/route.php?u=$1 last;
rewrite  ^/refer/(\d+)/index.html$ /pubfunc/videoplay.php?contentid=$1 last;
rewrite  ^/refer/(\d+)/v.swf /pubfunc/videotransfer.php?contentid=$1 last;
rewrite  ^/vod/(\d+).shtml$      /vod/play.php?vodid=$1 last;
#rewrite  ^/data/js/(\d+).js$ /data/js.php?id=$1 last;
rewrite  ^/newgallery/list/([a-zA-Z0-9]+).([s]?)html$ /newgallery/list.php?u=$1 last;
rewrite  ^/video/(\d+)/index.html$ /pubfunc/videoplay.php?contentid=$1 last;
rewrite  ^/video/(\d+)/v.swf$ /pubfunc/videotransfer.php?contentid=$1 last;
rewrite  ^/video/list/([a-zA-Z0-9]+).([s]?)html$ /video/list.php?u=$1 last;
rewrite  ^/video/play/([a-zA-Z0-9]+).([s]?)html$ /video/play.php?id=$1 last;
rewrite  ^/video/([a-z])/([0-9]+)/v.swf$ /video/trans.php?trans=$1&id=$2 last;
#rewrite  ^/video/t/([0-9]+)/v.swf$ /video/trans.php?id=$1 last;
#rewrite  ^/video/m/([0-9]+)/v.swf$ /video/trans.php?id=$1&m=1 last;
#rewrite  ^/video/p/([0-9]+)/v.swf$ /video/trans.php?id=$1&p=1 last;
rewrite  ^/([^-]+)/([^-]+)-p\.html$ /$1/$2.php last;
rewrite  ^/([^-]+)/([^-]+)-p-([^-]+)-([^-]+)\.html$ /$1/$2.php?$3=$4 last;
rewrite  ^/([^-]+)/([^-]+)-p-([^-]+)-([^-]+)-([^-]+)-([^-]+)\.html$ /$1/$2.php?$3=$4&$5=$6 last;
rewrite  ^/(.*)/list-p-(\d+)-([^-/]+)-([^-/]+)\.html /list.php?catid=$2&$3=$4 last;
rewrite  ^/(.*)/list-p-(\d+)-([^-/]+)-([^-/]+)-([^-/]+)-([^-/]+)\.html /list.php?catid=$2&$3=$4&$5=$6 last;
rewrite  ^/([^-]+)/([^-]+)-p-([^-]+)-([^-]+)-([^-]+)-([^-]+)-([^-]+)-([^-]+)\.html$ /$1/$2.php?$3=$4&$5=$6&$7=$8 last;
rewrite  ^/([^-]+)/index-p-([^-]+)-([^-]+)-([^-]+)-([^-]+)-([^-]+)-([^-]+)-([^-]+)-([^-]+)\.html$ /$1/index.php?$2=$3&$4=$5&$6=$7&$8=$9 last;
rewrite  ^/([^-]+)-p\.[ht|x]+ml$ /$1.php last;
rewrite  ^/([^-]+)-p-([^-]+)-([^-]+)\.[ht|x]+ml$ /$1.php?$2=$3 last;
rewrite  ^/([^-]+)-p-([^-]+)-([^-]+)-([^-]+)-([^-]+)\.[ht|x]+ml$ /$1.php?$2=$3&$4=$5 last;
rewrite  ^/([^-]+)-p-([^-]+)-([^-]+)-([^-]+)-([^-]+)-([^-]+)-([^-]+)\.[ht|x]+ml$ /$1.php?$2=$3&$4=$5&$6=$7 last;
rewrite  ^/([^-]+)-p-([^-]+)-([^-]+)-([^-]+)-([^-]+)-([^-]+)-([^-]+)-([^-]+)-([^-]+)\.[ht|x]+ml$ /$1.php?$2=$3&$4=$5&$6=$7&$8=$9 last;
rewrite  ^/newgallery/hdpic/(\d+)\.([s]?)html$ /newgallery/hdpic.php?groupid=$1&start=1 last;
rewrite  ^/newgallery/hdpic/(\d+)_(\d+)\.([s]?)html$ /newgallery/hdpic.php?groupid=$1&start=$2 last;
rewrite  ^/vod/list/([^\/].*)/([a-zA-Z0-9]+)\.([s]?)html$ /vod/list.php?sk=$1&vk=$2 last;
rewrite  ^/rank/(.+)/? /rank/route.php?u=$1 last;
rewrite  ^/faqhelp/(.+)/? /faqhelp/route.php?u=$1 last;
rewrite  ^/yx/(.+)/? /yx/route.php?u=$1 last;
rewrite  ^/special/([^-/]+)/([^-/]+)/([0-9]+)_([0-9]+).html$ /special/showForDeveloper.php?specialid=$3&page=$4 last;
rewrite  ^/vod/rank/([^/]+).shtml$ /vod/ranknew.php?u=$1 last;
rewrite  ^/vod/listvideo/([a-zA-Z0-9]+).([s]?)html$ /vod/listvideo.php?u=$1 last;
rewrite  ^/vplan/? /special/filmfest/vmovie/ last;
rewrite  ^/jobs/(.+)/? /jobs/route.php?u=$1 last;
rewrite  ^/vod/vip/([^\/].*)/([a-zA-Z0-9]+)\.([s]?)html$ /vod/vip.php?sk=$1&vk=$2 last;
rewrite  ^/special/([^-/]+)/([^-/]+)/([0-9]+)-([^-]+)\.html$ /special/mshow.php?specialid=$3&tpl=$4&$query_string last;

rewrite  ^/cctv6/([a-z]+\/[a-z]+\/list[\w_\.\/]*)$ /cctv6/route.php?u=$1 last;
