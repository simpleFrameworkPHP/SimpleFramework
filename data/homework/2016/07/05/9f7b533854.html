<!DOCTYPE html>
<html>
<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <link rel="stylesheet" href="http://localhost/SimpleFramework/public/home/css/main.css" type="text/css"/>
</head>
<body>
<div class="div_menu">
    <ul>        <li>管理员</li>
        <li><a href="http://localhost/SimpleFramework/index.php?a=home&c=index&f=logout">退出</a></li>
            </ul>
</div>
<div class="div_login hidden">
    <form action="http://localhost/SimpleFramework/index.php?a=home&c=index&f=login" method="POST">
        <table>
            <tr><th colspan="2">&nbsp;</th></tr>
            <tr><th>用户名：</th><td><input name="username"/></td></tr>
            <tr><th>密&nbsp;&nbsp;码：</th><td><input type="password" name="password"/></td></tr>
            <tr><th>&nbsp;&nbsp;</th><td><span class="btn submit">登 录</span>&nbsp;&nbsp;<span class="btn" onclick="window.location='http://localhost/SimpleFramework/index.php?a=admin&c=Content&f=register';">注 册</span></td></tr>
        </table>
    </form>
</div>
<div class="div_page">
    <div class="div_content"><h2 class="title">【跨域】关于p3p 简洁策略,以及浏览器的支持情况.</h2>
<div class="document"><p><img src="/SimpleFramework/data/image/2016/07/05/1467700110119981.jpg" title="98.jpg" alt="98.jpg"/></p><p>简述部分摘自某本关于P3P隐私策略的书籍.<br/></p><p>而部分详细的表格来自w3.org.</p><p>而相关测试数据出自本人测试.如有遗漏或错误,欢迎指正.</p><p>&nbsp;</p><p>相关资源:</p><p>1.&nbsp;<a href="http://www.w3.org/P3P/" style="cursor: pointer; color: rgb(70, 70, 70); text-decoration: none; background-color: inherit;">http://www.w3.org/P3P/</a></p><p>2.&nbsp;<a href="http://www.w3.org/TR/2002/REC-P3P-20020416/" style="cursor: pointer; color: rgb(70, 70, 70); text-decoration: none; background-color: inherit;">http://www.w3.org/TR/2002/REC-P3P-20020416/</a></p><p style="background-color: inherit;">&nbsp;</p><p>&nbsp;</p><p><strong style="background-color: inherit;"><span style="font-size: 24pt; background-color: inherit;">简述:</span></strong></p><p style="background-color: inherit;"><strong style="background-color: inherit;"><span style="font-size: 24pt; background-color: inherit;">&nbsp;</span></strong></p><p>从本质上来说，<strong style="background-color: inherit;">P3P 策略是由一系列多选项问题的答案组成的</strong>，因此，它并不总像一个人类可读的隐私策略那样包含许多信息细节（例如，用英语或者其他某种口语语言写成的策略是用来让人阅读的,而不是让计算机识别的）。P3P策略的标准格式使它便于自动处理。同 样 ，<strong style="background-color: inherit;">P3P规范也包含有用于请求和传输P3P策略的协议.</strong><strong style="background-color: inherit;">P3P协议所基于的HTTP协议与 Web 浏览器用来与 Web服务器进行通信的 HTTP 协议相同</strong>。如图 1-1 所示，P3P 的用户代理使用标准的 HTTP 请求从 Web 站点上一个众所周知的地方获取 P3P 策略引用文件，并发送给发出请求的用户。这个策略引用文件指出了Web站点上各个部分所应用的P3P策略文件的位置。整个站点有可能只应用了一种策略，也可能是网站的不同部分分别应用了几种策略。这样用户代理就可以根据用户的选择来获取合适的策略，将其解析出来并采取相应的动作</p><p>&nbsp;</p><p>&nbsp;</p><p>P3P 也允许站点在其他位置放置策略引用文件。在这些情况下，站点在声明策略引用文件的位置时，必须使用一个特定的 HTTP 报头，或者在应用了 P3P 策略的H T M L 文 件 内 嵌 入 一 个 L I N K 标 记 .</p><p><strong style="background-color: inherit;">不论在何时设置cookie都可以用特定的HTTP报头来传送一个可选的 P3P 简洁策略.</strong>简洁策略是完整 P3P 策略的一个短小摘要，仅描述了与cooki e 相关的数据处理方式，并且不需要P3P 策略的完整的表达性能.</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><strong style="background-color: inherit;">如何使Web站点支持P3P:</strong><br style="background-color: inherit;"/>从技术角度看，使 Web站点支持 P3P 是一个很容易的过程。但是，它要求网络运营商在审视数据处理方式时比以前更加仔细，并要求他们协调域内各个主机上的策略和处理方式。以下是如何使站点支持P3P 技术的具体步骤。</p><p><br style="background-color: inherit;"/>1. 创建一个隐私策略。<br style="background-color: inherit;"/>2. 分析 cookie 的使用情况以及您的站点上的第三方内容。<br style="background-color: inherit;"/>3. 确定要对整个站点应用一个P3P策略还是对站点的不同部分应用不同的P3P 策略。<br style="background-color: inherit;"/>4. 为站点创建一个或几个 P3P 策略。<br style="background-color: inherit;"/>5. 为站点创建一个策略引用文件。<br style="background-color: inherit;"/>6. 为 P3P 配置服务器。<br style="background-color: inherit;"/>7. 测试站点，以确定它确实支持 P3P。</p><p>&nbsp;</p><p>&nbsp;</p><p>大多数支持P3P 的Web站点会在每台服务器上放置一个P3P策略引用文件，同时它还会在中央服务器上放置一个或多个P3P策略。这些站点也会将自己的服务器配置为用户在设置 cooki e 时发送 P3P 的简洁策略。P3P 策略包括以下信息：</p><p><br style="background-color: inherit;"/>● 如何与拥有该站点的公司、组织或个人进行联系的信息。<br style="background-color: inherit;"/>● 用户是否可以查找该站点的数据库中保存了自己的哪些个人信息。<br style="background-color: inherit;"/>● 如何解决与站点之间有关隐私的纠纷（如客户服务台、隐私封印以及与隐私相关的法律等）。<br style="background-color: inherit;"/>● 所收集数据的种类。<br style="background-color: inherit;"/>● 所收集数据的使用方式，以及用户是否能选择接受或拒绝这些用途。<br style="background-color: inherit;"/>● 信息是否会被共享以及何时被共享，用户是否有选择的权力。<br style="background-color: inherit;"/>● 对所收集的用户信息进行定期清除的策略。</p><p><br style="background-color: inherit;"/>有很多软件工具可以帮助Web站点开发人员开发支持P3P的站点。</p><p>要想了解最新的P3P 工具列表，请访问http://p3ptoolbox.org/tools/&nbsp;&nbsp; &nbsp;&nbsp;和&nbsp;&nbsp; &nbsp;&nbsp;http://www.w3.org/P3P/implementations/</p><p>&nbsp;</p><p>&nbsp;</p><hr style="background-color: inherit;"/><p>&nbsp;</p><p>&nbsp;</p><h2 style="font-size: 21px; background-color: inherit;"><span style="font-size: 24pt; background-color: inherit;"><strong style="background-color: inherit;">简洁策略对应的 HTTP Response Header :</strong></span></h2><p style="background-color: inherit;"><strong style="background-color: inherit;">&nbsp;</strong></p><p><strong style="background-color: inherit;">相关资源:</strong><a href="http://www.w3.org/2002/04/P3Pv1-header.html#anchor1" style="cursor: pointer; color: rgb(70, 70, 70); text-decoration: none; background-color: inherit;">http://www.w3.org/2002/04/P3Pv1-header.html</a>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>Compact Policies<strong style="background-color: inherit;">(简洁策略)</strong><span style="color: rgb(121, 121, 121); background-color: inherit;"><br style="background-color: inherit;"/></span></p><p>&nbsp;</p><p>简洁策略,本质上就是P3P策略的一个摘要. 他们的作用是,使用户代理,可以快速敏捷的获取到站点的P3P策略信息,所以是对性能有益的.</p><p>为了深入的解释简洁策略,按照 P3P1.0[4]规范,我们列出下面这些限制性的语法：</p><p><br style="background-color: inherit;"/><br style="background-color: inherit;"/>compact-policy-field &nbsp; &nbsp; &nbsp; &nbsp; = &nbsp; `CP=&quot;` compact-policy `&quot;`<br style="background-color: inherit;"/><br style="background-color: inherit;"/>compact-policy &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= compact-token *(&quot; &quot; compact-token)<br style="background-color: inherit;"/><br style="background-color: inherit;"/>compact-token &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;&nbsp;= compact-access&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</p><p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; compact-disputes&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</p><p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;compact-remedies&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</p><p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; compact-non-identifiable |</p><p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; compact-purpose&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</p><p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; compact-recipient&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</p><p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;compact-retention&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</p><p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; compact-categories&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</p><p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; compact-test&nbsp;</p><p><br style="background-color: inherit;"/><strong style="background-color: inherit;">compact-access</strong>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = &quot;NOI&quot; | &quot;ALL&quot; | &quot;<strong style="background-color: inherit;">CAO</strong>&quot; | &quot;IDC&quot; | &quot;OTI&quot; | &quot;NON&quot;<br style="background-color: inherit;"/><br style="background-color: inherit;"/>compact-disputes &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= &quot;DSP&quot;<br style="background-color: inherit;"/><br style="background-color: inherit;"/>compact-remedies &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= &quot;COR&quot; | &quot;MON&quot; | &quot;LAW&quot;<br style="background-color: inherit;"/><br style="background-color: inherit;"/>compact-non-identifiable = &quot;NID&quot;<br style="background-color: inherit;"/><br style="background-color: inherit;"/><strong style="background-color: inherit;">compact-purpose</strong>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = &quot;CUR&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | &quot;ADM&quot; [creq] | &quot;DEV&quot; [creq] | &quot;TAI&quot; [creq] |<br style="background-color: inherit;"/>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&quot;<strong style="background-color: inherit;">PSA&quot; [creq]</strong>&nbsp;| &quot;PSD&quot; [creq] | &quot;IVA&quot; [creq] | &quot;IVD&quot; [creq] |&nbsp;</p><p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;CON&quot; [creq] | &quot;HIS&quot; [creq] | &quot;TEL&quot; [creq] | &quot;OTP&quot; [creq]</p><p><br style="background-color: inherit;"/>creq &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;&nbsp;= &quot;a&quot; | &quot;i&quot; | &quot;o&quot;</p><p><br style="background-color: inherit;"/><strong style="background-color: inherit;">compact-recipient</strong>&nbsp;&nbsp; &nbsp; &nbsp; = &quot;<strong style="background-color: inherit;">OUR</strong>&quot; | &quot;DEL&quot; [creq] | &quot;SAM&quot; [creq] | &quot;UNR&quot; [creq] |<br style="background-color: inherit;"/>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&quot;PUB&quot; [creq] | &quot;OTR&quot; [creq]</p><p><br style="background-color: inherit;"/>compact-retention &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= &quot;NOR&quot; | &quot;STP&quot; | &quot;LEG&quot; | &quot;BUS&quot; | &quot;IND&quot;<br style="background-color: inherit;"/><br style="background-color: inherit;"/>compact-category &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = &quot;PHY&quot; | &quot;ONL&quot; | &quot;UNI&quot; | &quot;PUR&quot; | &quot;FIN&quot; | &quot;COM&quot; |</p><blockquote style="background-color: inherit;"><p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;NAV&quot; | &quot;INT&quot; | &quot;DEM&quot; | &quot;CNT&quot; | &quot;STA&quot; | &quot;POL&quot; |&nbsp;</p></blockquote><p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;HEA&quot; | &quot;PRE&quot; | &quot;LOC&quot; | &quot;GOV&quot; | &quot;OTC&quot;</p><p><br style="background-color: inherit;"/>compact-test &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= &quot;TST&quot;</p><p>&nbsp;</p><p style="background-color: inherit;">&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p style="background-color: inherit;"><strong style="background-color: inherit;">我们常用的简洁策略的 P3P头为</strong>&nbsp;- &nbsp; P3P :&nbsp;<strong style="background-color: inherit;">CP=CAO PSA OUR</strong>&nbsp;<span style="color: rgb(50, 135, 18); background-color: inherit;">（其实, CP=. 就可以了.或者其他任何值都是可以的）</span>分别对应了 :</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p style="background-color: inherit;"><strong style="background-color: inherit;">　　compact-access(访问) &nbsp; &nbsp;: &nbsp;CAO - &nbsp;contact-and-other&nbsp;</strong></p><p><span style="color: rgb(121, 121, 121); background-color: inherit;">Identified Contact Information and Other Identified Data: access is given to identified online and physical contact information as well as to certain other identified data.</span></p><p>直译 : 被识别的联系信息,和其他被识别的数据: 网上,或现实中的联系信息,和某些被识别的数据,允许被访问.&nbsp;</p><p><span style="font-family: sans-serif; background-color: inherit;">我的理解: 应该是, 允许被确认的信息和数据的访问. (允许第三方cookie的读写)</span></p><p>&nbsp;</p><p>&nbsp;</p><p style="background-color: inherit;"><strong style="background-color: inherit;">　　compact-purpose(目的) &nbsp;: &nbsp;PSA - &nbsp;pseudo-analysis .</strong>这个就不放解释了,字面意思很明显, 目的就是做身份验证、分析</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p style="background-color: inherit;"><strong style="background-color: inherit;">　　compact-recipient(受体) : &nbsp;OUR - ours</strong></p><p><span style="color: rgb(121, 121, 121); font-family: sans-serif; background-color: inherit;">Ourselves and/or entities acting as our agents or entities for whom we are acting as an agent: An agent in this instance is defined as a third party that processes data only on behalf of the service provider for the completion of the stated purposes. (e.g., the service provider and its printing bureau which prints address labels and does nothing further with the information</span></p><p>直译 : &nbsp;我们自己,以及（或）实体作为我们自己的代理,或被我们所代理方的实体:这种情况下的代理,被定义为,相关进程数据,代表服务提供者,用来完成其所设定服务的,第三方.(就好像,一个印刷局作为提供打印服务的,服务提供者,其只负责打印标签神马的,但是却不会进一步,对相关的信息,做任何事情 )</p><p>&nbsp;</p><p>我的理解:声明使用相关信息的人是谁.这里声明是第三方自己, 或作为代理.需要操作第三方Cookie. 大概就是这个意思.</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p style="background-color: inherit;"><strong style="background-color: inherit;">　　ps : 其他项就不列举,基于浏览器中只有IE支持.(chrome 部分支持).这一事实.深入研究没有必要. 如果你有兴趣,可以去相关链接查看文档.</strong></p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p style="background-color: inherit;">&nbsp;</p><hr style="background-color: inherit;"/><p style="background-color: inherit;"><strong style="background-color: inherit;">&nbsp;</strong></p><p><span style="font-size: 24pt; background-color: inherit;"><strong style="background-color: inherit;">用户代理对简洁策略支持的状况 和实现, 拿IE6来说:</strong></span></p><p style="background-color: inherit;">&nbsp;</p><p>&nbsp;</p><p>IE6 ，可以自动核对设置了 cooki e的站点的 P3P 简洁策略。用户也可以配置 IE6 来过滤那些没有简洁策略的cookie，或那些具有与他们的偏好不相匹配的简洁策略。当 cookie 被阻止时，IE6还会在浏览器的右下角显示一个“眼睛”符号。用户也可以从Vi ew（查看）菜单中选择Privacy Report（隐私报告）命令来让 IE6 获取站点的 P3P 策略，并生成及显示一个人们可读取的版本</p><p>&nbsp;</p><p>对于众多提示性的反馈,是十分符合 P3P隐私策略的.即用户代理应该在恰当的时候,提醒用户.<br style="background-color: inherit;"/><br style="background-color: inherit;"/></p><hr style="background-color: inherit;"/><p>&nbsp;</p><h2 style="font-size: 21px; background-color: inherit;"><span style="font-size: 24pt; background-color: inherit;"><strong style="background-color: inherit;">已测知的问题:</strong></span></h2><p style="background-color: inherit;">&nbsp;</p><p>&nbsp;</p><p><strong style="background-color: inherit;">IE6 第三方cookie 在有p3p头(使用p3p简洁策略时)</strong>&nbsp;,JS虽然有读写权限,但是在写的时候有个bug. 即,对于某第三方页面,如果是首次读到.其P3P头的话,则 js的写权限是没有的.必须要第二次访问到这个页面,且这个页面存在第三方cookie操作时,才允许JS写入Cookie.当然,读是一直没问题的.</p><p><br style="background-color: inherit;"/></p><p><strong style="background-color: inherit;">Safair3,则顽固到连Post方式都无法写入第三方Cookie.</strong></p><p><strong style="background-color: inherit;">&nbsp;</strong></p><p><strong style="background-color: inherit;">Safari4+ 系列则有自己一套隐私策略,而完全无视P3P的存在:</strong></p><p>在其不支持P3P的情况下,其策略为. 默认设置浏览器禁止第三方Cookie操作.那么此时,无论JS 还是 HTTP ，都无写入Cookie的权限,而仅具备读的权限.&nbsp;</p><p>除非, 进行表单Post时,才允许第三方Cookie的写入.参考下面的代码: (在//www.a.com/test.htm 中的代码)</p><blockquote style="background-color: inherit;"><p>&nbsp;</p><p><span style="color: rgb(121, 121, 121); background-color: inherit;">if(Safari4或Safari5){</span></p><p><span style="color: rgb(121, 121, 121); background-color: inherit;">&nbsp;&nbsp;&nbsp; var ifm = document.createElement(&#39;iframe&#39;);</span></p><p><span style="color: rgb(121, 121, 121); background-color: inherit;">&nbsp;&nbsp;&nbsp; ifm.name =&quot;postforcookie&quot;;</span></p><p><span style="color: rgb(121, 121, 121); background-color: inherit;">&nbsp;&nbsp;&nbsp; ifm.src=&quot;about:blank&quot;;</span></p><p><span style="color: rgb(121, 121, 121); background-color: inherit;">&nbsp;&nbsp;&nbsp; document.body.appendChild(ifm);</span></p><p><span style="color: rgb(121, 121, 121); background-color: inherit;">&nbsp;&nbsp;&nbsp;</span></p><p><span style="color: rgb(121, 121, 121); background-color: inherit;">&nbsp;&nbsp;&nbsp; var form = document.createElement(&#39;form&#39;);</span></p><p><span style="color: rgb(121, 121, 121); background-color: inherit;">&nbsp;&nbsp;&nbsp; form.target = &#39;postforcookie&#39;;</span></p><p><span style="color: rgb(121, 121, 121); background-color: inherit;">&nbsp;&nbsp;&nbsp; form.action = &#39;//www.php.com/test.php&#39;;</span></p><p><span style="color: rgb(121, 121, 121); background-color: inherit;">&nbsp;&nbsp;&nbsp; document.body.appendChild(form);</span></p><p><span style="color: rgb(121, 121, 121); background-color: inherit;">&nbsp;&nbsp;&nbsp;</span></p><p><span style="color: rgb(121, 121, 121); background-color: inherit;">&nbsp;&nbsp;&nbsp; Cookie.setCookie = function () {</span></p><p><span style="color: rgb(121, 121, 121); background-color: inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; form.submit();</span></p><p><span style="color: rgb(121, 121, 121); background-color: inherit;">&nbsp;&nbsp;&nbsp; }</span></p><p><span style="color: rgb(121, 121, 121); background-color: inherit;">} &nbsp;</span></p></blockquote><p><span style="color: rgb(121, 121, 121); background-color: inherit;">&nbsp;</span></p><p>假设,setCookie是一个写入第三方Cookie的函数,则在Sacari4,Sacari5下劫持他们,触发代码中 form的submit即可.</p><p>此时,如果//www.php.com/test.php，有写入Cookie的操作.则可以保证第三方Cookie被写入.</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><hr style="background-color: inherit;"/><h2 style="font-size: 21px; background-color: inherit;"><span style="font-size: 24pt; background-color: inherit;"><strong style="background-color: inherit;">默认不禁止第三方cookie的浏览器测试:</strong></span></h2><p style="background-color: inherit;"><strong style="background-color: inherit;">&nbsp;</strong></p><p>测试为在下列浏览器中,禁止第三方Cookie,并配置简洁P3P策略.</p><p>&nbsp;</p><p>&nbsp;</p><p><strong style="background-color: inherit;">Firefox下</strong>&nbsp;:</p><p>Firefox下禁止第三方Cookie后，很直接, 无论HTTP 还是 JS都无法读写Cookie.</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><strong style="background-color: inherit;">Chrome:</strong></p><p>Chrome10 开始 支持用户自定义是否允许在 地址栏: about:flags 中配置 是否允许第三方cookie.</p><p>而之前的版本需要通过, 选项-高级选项-隐私权-内容设置-拦截第三方cookie 来配置.</p><p>&nbsp;</p><p>&nbsp;</p><p>对于chrome9 和之前的Dev版本来说,通过选项配置禁止第三方cookie后, 在配置P3P简洁策略后, JS 可读cookie,但不能写,而 HTTP方式,则都可以.</p><p>而chrome10+ 无论选择什么方式设置, 只允许HTTP、JS读,但是不允许写.</p><p>&nbsp;</p><p>而Chrome的非Dev版, 甚至没有提供第三方Cookie的隐私策略选项. 有的仅仅是,关于Cookie的站点允许列表,或者主动访问过的站点的Cookie.</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><strong style="background-color: inherit;">Opera:</strong></p><p>通过 工具-首选项-高级-Cookie-仅接受来自我访问站点的Cookie 来设置禁止第三方Cookie.</p><p>&nbsp;</p><p>&nbsp;</p><p>Opera的有趣之处在于,一但禁止第三方Cookie,则 P3P头毫无意义,而Opera自身的隐私策略则非常有趣,</p><p>允许JS 的读写,以及HTTP的读, 但是禁止HTTP 对Cookie的写入.</p><p>&nbsp;</p><p><br style="background-color: inherit;"/><br style="background-color: inherit;"/></p><hr style="background-color: inherit;"/><p style="background-color: inherit;"><strong style="background-color: inherit;"><strong style="background-color: inherit;">&nbsp;</strong></strong></p><p><strong style="background-color: inherit;"><span style="font-size: 24pt; background-color: inherit;">总结:</span></strong></p><p style="background-color: inherit;"><strong style="background-color: inherit;"><span style="font-size: 24pt; background-color: inherit;">&nbsp;</span></strong></p><p><strong style="background-color: inherit;">&nbsp;</strong></p><table cellpadding="2" cellspacing="0"><tbody style="background-color: inherit;"><tr style="background-color: inherit;" class="firstRow"><td valign="top" style="word-break: break-all; border-color: rgb(153, 153, 153); padding-right: 16px; padding-left: 12px; min-height: 25px; min-width: 25px; background-color: inherit;" height="25"><strong style="background-color: inherit;">浏览器</strong></td><td valign="top" style="word-break: break-all; border-color: rgb(153, 153, 153); padding-right: 16px; padding-left: 12px; min-height: 25px; min-width: 25px; background-color: inherit;" height="25"><strong style="background-color: inherit;">默认允许第三方Cookie</strong></td><td valign="top" style="word-break: break-all; border-color: rgb(153, 153, 153); padding-right: 16px; padding-left: 12px; min-height: 25px; min-width: 25px; background-color: inherit;" height="25"><strong style="background-color: inherit;">是否支持P3P</strong></td><td valign="top" style="word-break: break-all; border-color: rgb(153, 153, 153); padding-right: 16px; padding-left: 12px; min-height: 25px; min-width: 25px; background-color: inherit;" height="25"><strong style="background-color: inherit;">禁止第三方Cookie后,配置P3P简明策略头的效果</strong></td><td valign="top" style="word-break: break-all; border-color: rgb(153, 153, 153); padding-right: 16px; padding-left: 12px; min-height: 25px; min-width: 25px; background-color: inherit;" height="25"><strong style="background-color: inherit;">补充</strong></td></tr><tr style="background-color: inherit;"><td valign="top" style="word-break: break-all; border-color: rgb(153, 153, 153); padding-right: 16px; padding-left: 12px; min-height: 25px; min-width: 25px; background-color: inherit;" height="25"><strong style="background-color: inherit;">IE6</strong></td><td valign="top" style="word-break: break-all; border-color: rgb(153, 153, 153); padding-right: 16px; padding-left: 12px; min-height: 25px; min-width: 25px; background-color: inherit;" height="25"><span style="color: rgb(227, 0, 0); background-color: inherit;">否</span></td><td valign="top" style="word-break: break-all; border-color: rgb(153, 153, 153); padding-right: 16px; padding-left: 12px; min-height: 25px; min-width: 25px; background-color: inherit;" height="25"><span style="color: rgb(50, 135, 18); background-color: inherit;">是</span></td><td valign="top" style="word-break: break-all; border-color: rgb(153, 153, 153); padding-right: 16px; padding-left: 12px; min-height: 25px; min-width: 25px; background-color: inherit;" height="25"><p style="margin-top: 5px; margin-bottom: 5px; background-color: inherit;">HTTP可读写Cookie<br style="background-color: inherit;"/>JS可读Cookie<br style="background-color: inherit;"/><span style="color: rgb(227, 0, 0); background-color: inherit;">首次读到P3P头,JS无写Cookie权限.第二次才OK</span></p><p style="margin-top: 5px; margin-bottom: 5px; background-color: inherit;"><span style="color: rgb(227, 0, 0); background-color: inherit;">(第二次.直接Cache.也不行.除非第一次非Cache并读到p3p头.后面我会提到解决方案.)</span></p></td><td valign="top" style="word-break: break-all; border-color: rgb(153, 153, 153); padding-right: 16px; padding-left: 12px; min-height: 25px; min-width: 25px; background-color: inherit;" height="25">避免JS的写操作</td></tr><tr style="background-color: inherit;"><td valign="top" style="word-break: break-all; border-color: rgb(153, 153, 153); padding-right: 16px; padding-left: 12px; min-height: 25px; min-width: 25px; background-color: inherit;" height="25"><p><strong style="background-color: inherit;">IE7-IE9</strong></p></td><td valign="top" style="word-break: break-all; border-color: rgb(153, 153, 153); padding-right: 16px; padding-left: 12px; min-height: 25px; min-width: 25px; background-color: inherit;" height="25"><span style="color: rgb(227, 0, 0); background-color: inherit;">否</span></td><td valign="top" style="word-break: break-all; border-color: rgb(153, 153, 153); padding-right: 16px; padding-left: 12px; min-height: 25px; min-width: 25px; background-color: inherit;" height="25"><span style="color: rgb(50, 135, 18); background-color: inherit;">是</span></td><td valign="top" style="word-break: break-all; border-color: rgb(153, 153, 153); padding-right: 16px; padding-left: 12px; min-height: 25px; min-width: 25px; background-color: inherit;" height="25"><span style="color: rgb(50, 135, 18); background-color: inherit;">HTTP、JS,可随意读写.</span></td><td valign="top" style="word-break: break-all; border-color: rgb(153, 153, 153); padding-right: 16px; padding-left: 12px; min-height: 25px; min-width: 25px; background-color: inherit;" height="25">-</td></tr><tr style="background-color: inherit;"><td valign="top" style="word-break: break-all; border-color: rgb(153, 153, 153); padding-right: 16px; padding-left: 12px; min-height: 25px; min-width: 25px; background-color: inherit;" height="25"><strong style="background-color: inherit;">FireFox</strong></td><td valign="top" style="word-break: break-all; border-color: rgb(153, 153, 153); padding-right: 16px; padding-left: 12px; min-height: 25px; min-width: 25px; background-color: inherit;" height="25"><span style="color: rgb(50, 135, 18); background-color: inherit;">是</span></td><td valign="top" style="word-break: break-all; border-color: rgb(153, 153, 153); padding-right: 16px; padding-left: 12px; min-height: 25px; min-width: 25px; background-color: inherit;" height="25"><span style="color: rgb(227, 0, 0); background-color: inherit;">否</span></td><td valign="top" style="word-break: break-all; border-color: rgb(153, 153, 153); padding-right: 16px; padding-left: 12px; min-height: 25px; min-width: 25px; background-color: inherit;" height="25"><span style="color: rgb(227, 0, 0); background-color: inherit;">HTTP、JS都不可读写</span></td><td valign="top" style="word-break: break-all; border-color: rgb(153, 153, 153); padding-right: 16px; padding-left: 12px; min-height: 25px; min-width: 25px; background-color: inherit;" height="25">-</td></tr><tr style="background-color: inherit;"><td valign="top" style="word-break: break-all; border-color: rgb(153, 153, 153); padding-right: 16px; padding-left: 12px; min-height: 25px; min-width: 25px; background-color: inherit;" height="25"><strong style="background-color: inherit;">Chrome</strong></td><td valign="top" style="word-break: break-all; border-color: rgb(153, 153, 153); padding-right: 16px; padding-left: 12px; min-height: 25px; min-width: 25px; background-color: inherit;" height="25"><span style="color: rgb(50, 135, 18); background-color: inherit;">是</span></td><td valign="top" style="word-break: break-all; border-color: rgb(153, 153, 153); padding-right: 16px; padding-left: 12px; min-height: 25px; min-width: 25px; background-color: inherit;" height="25"><span style="color: rgb(222, 87, 0); background-color: inherit;">部分支持,趋势-否</span></td><td valign="top" style="word-break: break-all; border-color: rgb(153, 153, 153); padding-right: 16px; padding-left: 12px; min-height: 25px; min-width: 25px; background-color: inherit;" height="25">趋势为HTTP、JS可读不可写.</td><td valign="top" style="word-break: break-all; border-color: rgb(153, 153, 153); padding-right: 16px; padding-left: 12px; min-height: 25px; min-width: 25px; background-color: inherit;" height="25">-</td></tr><tr style="background-color: inherit;"><td valign="top" style="word-break: break-all; border-color: rgb(153, 153, 153); padding-right: 16px; padding-left: 12px; min-height: 25px; min-width: 25px; background-color: inherit;" height="25"><strong style="background-color: inherit;">Safari</strong></td><td valign="top" style="word-break: break-all; border-color: rgb(153, 153, 153); padding-right: 16px; padding-left: 12px; min-height: 25px; min-width: 25px; background-color: inherit;" height="25"><span style="color: rgb(227, 0, 0); background-color: inherit;">否</span></td><td valign="top" style="word-break: break-all; border-color: rgb(153, 153, 153); padding-right: 16px; padding-left: 12px; min-height: 25px; min-width: 25px; background-color: inherit;" height="25"><span style="color: rgb(227, 0, 0); background-color: inherit;">否</span></td><td valign="top" style="word-break: break-all; border-color: rgb(153, 153, 153); padding-right: 16px; padding-left: 12px; min-height: 25px; min-width: 25px; background-color: inherit;" height="25">HTTP、JS可读不可写</td><td valign="top" style="word-break: break-all; border-color: rgb(153, 153, 153); padding-right: 16px; padding-left: 12px; min-height: 25px; min-width: 25px; background-color: inherit;" height="25">借助Post提交表单,实现写操作.</td></tr><tr style="background-color: inherit;"><td valign="top" style="word-break: break-all; border-color: rgb(153, 153, 153); padding-right: 16px; padding-left: 12px; min-height: 25px; min-width: 25px; background-color: inherit;" height="25"><strong style="background-color: inherit;">Opera</strong></td><td valign="top" style="word-break: break-all; border-color: rgb(153, 153, 153); padding-right: 16px; padding-left: 12px; min-height: 25px; min-width: 25px; background-color: inherit;" height="25"><span style="color: rgb(50, 135, 18); background-color: inherit;">是</span></td><td valign="top" style="word-break: break-all; border-color: rgb(153, 153, 153); padding-right: 16px; padding-left: 12px; min-height: 25px; min-width: 25px; background-color: inherit;" height="25"><p>否</p></td><td valign="top" style="word-break: break-all; border-color: rgb(153, 153, 153); padding-right: 16px; padding-left: 12px; min-height: 25px; min-width: 25px; background-color: inherit;" height="25">JS可读写<br style="background-color: inherit;"/>HTTP可读不可写.</td><td valign="top" style="word-break: break-all; border-color: rgb(153, 153, 153); padding-right: 16px; padding-left: 12px; min-height: 25px; min-width: 25px; background-color: inherit;" height="25">-</td></tr></tbody></table><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><h2 style="font-size: 21px; background-color: inherit;"><span style="font-size: 24pt; background-color: inherit;"><strong style="background-color: inherit;">建议:</strong></span></h2><p style="background-color: inherit;"><span style="font-size: 24pt; background-color: inherit;"><strong style="background-color: inherit;">&nbsp;</strong></span></p><p>1. 其实P3P简洁策略,可以最简写成: P3P:CP=. 就OK啦,也就是说IE对P3P简洁策略的支持，属于搞笑级别的.根本不看内容,至少对于第三方操作cookie是如此的.</p><p>2. IE6的实现有bug.需要注意.首次访问第三方页面,JS无法写入第三方Cookie的bug.建议尽量避免JS对Cookie的写操作.</p><p>3. 要搞定Safari,需要借助后台至少配置一个APP,与前台配合.5.14+已不可用.)</p><p>4. 对于第三方来说,建议避免使用JS操作Cookie,最多用来读,而不是写. 除非是和登录验证有关,否则建议使用Storage代替Cookie的使用.</p><p>&nbsp;</p><h1 style="font-size: 28px; background-color: inherit;"><span style="font-size: 24pt; background-color: inherit;">最后:</span></h1><p style="background-color: inherit;">如果你非要用在ie6下，用js写cookie. 那么有一个很悲剧的做法.. 服务器端给资源配置可缓存.(包括反向代理和客户端.) 然后想办法在IE6的时候刷新一次页面.这样就ok了. 刷新时一定要用 location.reload(false) &nbsp;即先忽略客户端缓存.尝试304服务器端校验客户端缓存可靠性..这样做的好处是.即保证了 cookie的写入性. 又保证,如果页面是静态资源.则反向代理的可用性.. 否则还是直接用动态资源,http方式去写好了. &nbsp;需要注意的是.除了页面刷新.譬如其他方式加载页面资源.试图通过预读其p3p简洁策略头.是无效的. 比如 用 script type=&quot;text/c&quot; 方式去预读一次. 如果你有这个想法。还是早早放弃的好.&nbsp;</p><p>&nbsp;ps : 如果遇到ie6 js死活都写不进去cookie&nbsp;<meta charset="utf-8"/>&nbsp;.至于为毛, 我也不知道..只知道,不声明编码方式. 可能导致 ie6 配置p3p后 js还是写不了cookie的bug,并提示 读不到隐私策略..balablabla 的.</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p style="background-color: inherit;">&nbsp;</p><p>分类:&nbsp;<a href="http://www.cnblogs.com/_franky/category/180153.html" style="cursor: pointer; color: rgb(70, 70, 70); text-decoration: none; background-color: inherit;">javascript</a>,&nbsp;<a href="http://www.cnblogs.com/_franky/category/277914.html" style="cursor: pointer; color: rgb(70, 70, 70); text-decoration: none; background-color: inherit;">前端优化</a></p><p>标签:&nbsp;<a href="http://www.cnblogs.com/_franky/tag/P3P/" style="cursor: pointer; color: rgb(70, 70, 70); text-decoration: none; background-color: inherit;">P3P</a>,&nbsp;<a href="http://www.cnblogs.com/_franky/tag/%E7%AE%80%E6%B4%81%E7%AD%96%E7%95%A5/" style="cursor: pointer; color: rgb(70, 70, 70); text-decoration: none; background-color: inherit;">简洁策略</a></p><p><br/></p></div>
</div>
<div class="div_footer">
    <span class="span_foot_link"><a href="http://www.xihady.com">嘻哈电影</a></span>
    <hr/>
    <span class="span_foot_title">©2014 本网站纯属给媳妇娱乐</span>
</div>
</div>
</body>
<script type="text/javascript" src="http://localhost/SimpleFramework/public/js/jquery-2.1.1.js"></script>
<script>
    $(function(){
        $(".btn_login").on('click',function(){
            $(".div_login").removeClass('hidden');
        });
        $('.submit').on('click',function(){
            $('form').submit();
        });
    });
</script>
</html>